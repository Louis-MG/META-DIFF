############# BUILD UNITIGS

rule bcalm:
    input:
        config["project_path"] + "pipeline_output/kmdiff_output/{condition}_kmers.fasta"
    output:
        config["project_path"] + "pipeline_output/kmdiff_output/{condition}_kmers.unitigs.fa"
    params:
        memory = config["bcalm_memory"],
        outfile = config["project_path"] + "pipeline_output/kmdiff_output/{condition}_kmers"
    threads: config["threads"]
    log:
        stdout = config["project_path"] + "/pipeline_output/logs/bcalm_{condition}.stdout",
        stderr = config["project_path"] + "/pipeline_output/logs/bcalm_{condition}.stderr"
    conda :
        "../../env/bcalm.yaml"
    shell:
        """
        bcalm -in {input} -out {params.outfile} -nb-cores {threads} -abundance-min 1 -max-memory {params.memory} > {log.stdout} 2> {log.stderr}
        echo -e ">ref-NC-003210.1-209461-211401-ListeriaMonocytogenes-actin-assembly-inducing-protein-precursor
GGAGTATAAGTGGGATTAAACAGATTTATGCGTGCGATGATGGTGGTTTTCATTACTGCCAATTGCATTACGATTAACCCCGACATAATATTTGCAGCGACAGATAGCGAAGATTCTAGTCTAAACACAGATGAATGGGA\
AGAAGAAAAAACAGAAGAGCAACCAAGCGAGGTAAATACGGGACCAAGATACGAAACTGCACGTGAAGTAAGTTCACGTGATATTAAAGAACTAGAAAAATCGAATAAAGTGAGAAATACGAACAAAGCAGACCTAATAG\
CAATGTTGAAAGAAAAAGCAGAAAAAGGTCCAAATATCAATAATAACAACAGTGAACAAACTGAGAATGCGGCTATAAATGAAGAGGCTTCAGGAGCCGACCGACCAGCTATACAAGTGGAGCGTCGTCATCCAGGATTG\
CCATCGGATAGCGCAGCGGAAATTAAAAAAAGAAGGAAAGCCATAGCATCATCGGATAGTGAGCTTGAAAGCCTTACTTATCCGGATAAACCAACAAAAGTAAATAAGAAAAAAGTGGCGAAAGAGTCAGTTGCGGATGC\
TTCTGAAAGTGACTTAGATTCTAGCATGCAGTCAGCAGATGAGTCTTCACCACAACCTTTAAAAGCAAACCAACAACCATTTTTCCCTAAAGTATTTAAAAAAATAAAAGATGCGGGGAAATGGGTACGTGATAAAATCG\
ACGAAAATCCTGAAGTAAAGAAAGCGATTGTTGATAAAAGTGCAGGGTTAATTGACCAATTATTAACCAAAAAGAAAAGTGAAGAGGTAAATGCTTCGGACTTCCCGCCACCACCTACGGATGAAGAGTTAAGACTTGCT\
TTGCCAGAGACACCAATGCTTCTTGGTTTTAATGCTCCTGCTACATCAGAACCGAGCTCATTCGAATTTCCACCACCACCTACGGATGAAGAGTTAAGACTTGCTTTGCCAGAGACGCCAATGCTTCTTGGTTTTAATGC\
TCCTGCTACATCGGAACCGAGCTCGTTCGAATTTCCACCGCCTCCAACAGAAGATGAACTAGAAATCATCCGGGAAACAGCATCCTCGCTAGATTCTAGTTTTACAAGAGGGGATTTAGCTAGTTTGAGAAATGCTATTA\
ATCGCCATAGTCAAAATTTCTCTGATTTCCCACCAATCCCAACAGAAGAAGAGTTGAACGGGAGAGGCGGTAGACCAACATCTGAAGAATTTAGTTCGCTGAATAGTGGTGATTTTACAGATGACGAAAACAGCGAGACA\
ACAGAAGAAGAAATTGATCGCCTAGCTGATTTAAGAGATAGAGGAACAGGAAAACACTCAAGAAATGCGGGTTTTTTACCATTAAATCCGTTTGCTAGCAGCCCGGTTCCTTCGTTAAGTCCAAAGGTATCGAAAATAAG\
CGCACCGGCTCTGATAAGTGACATAACTAAAAAAACGCCATTTAAGAATCCATCACAGCCATTAAATGTGTTTAATAAAAAAACTACAACGAAAACAGTGACTAAAAAACCAACCCCTGTAAAGACCGCACCAAAGCTAG\
CAGAACTTCCTGCCACAAAACCACAAGAAACCGTACTTAGGGAAAATAAAACACCCTTTATAGAAAAACAAGCAGAAACAAACAAGCAGTCAATTAATATGCCGAGCCTACCAGTAATCCAAAAAGAAGCTACAGAGAGC\
GATAAAGAGGAAATGAAACCACAAACCGAGGAAAAAATGGTAGAGGAAAGCGAATCAGCTAATAACGCAAACGGAAAAAATCGTTCTGCTGGCATTGAAGAAGGAAAACTAATTGCTAAAAGTGCAGAAGACGAAAAAGC\
GAAGGAAGAACCAGGGAACCATACGACGTTAATTCTTGCAATGTTAGCTATTGGCGTGTTCTCTTTAGGGGCGTTTATCAAAATTATTCAATTAAGAAAAAATAATTAAAAACACAGAACG" >> {output}
        """
